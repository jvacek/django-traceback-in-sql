[tox]
envlist =
    py{310,311,312}-django42-{sqlite,postgres,mysql}
    py{310,311,312,313,314}-django52-{sqlite,postgres,mysql}
skip_missing_interpreters = true
isolated_build = true

[testenv]
description = Run tests with {envname}
deps =
    django42: django>=4.2,<5.0
    django52: django>=5.2,<6.0
    pytest>=8.3.5
    pytest-django>=4.11.1
    postgres: psycopg>=3.1.8
    mysql: mysqlclient>=2.2.0

passenv =
    HOME
    USER
    CI

setenv =
    sqlite: DB_ENGINE=sqlite
    postgres: DB_ENGINE=postgres
    postgres: DB_NAME=django_traceback_in_sql_test
    postgres: DB_USER=testuser
    postgres: DB_PASSWORD=testpass
    postgres: DB_HOST={env:DB_HOST:localhost}
    postgres: DB_PORT={env:DB_PORT:5432}
    mysql: DB_ENGINE=mysql
    mysql: DB_NAME=django_traceback_in_sql_test
    mysql: DB_USER={env:DB_USER:testuser}
    mysql: DB_PASSWORD={env:DB_PASSWORD:testpass}
    mysql: DB_HOST={env:DB_HOST:localhost}
    mysql: DB_PORT={env:DB_PORT:3306}

commands =
    pytest -v {posargs}

[gh-actions]
python =
    3.10: py310
    3.11: py311
    3.12: py312
    3.13: py313
    3.14: py314
